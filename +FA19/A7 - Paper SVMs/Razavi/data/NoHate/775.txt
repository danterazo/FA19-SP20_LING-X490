Hello , I am porting some code from F77 to F90 to include some allocatable memory ( it is a CFD code ) . Unfortunately , I need to include some reallocatable storage for some of the routines some type specific realloc routines as below : ! SUBROUTINE RREALLOC1D ( PT1,N ) IMPLICIT NONE ! ! = ! PASSED THROUGH CALL STATEMENT ! = ! REAL , DIMENSION ( : ) , POINTER : PT1 INTEGER N ! ! = ! LOCAL VARIABLES ! = ! ! INTEGERS : ! INTEGER CHECKSTAT ! ! REALS : ! REAL , DIMENSION ( : ) , ALLOCATABLE , TARGET : TT2 ! IF ( .NOT.ALLOCATED ( TT2 ) ) THEN ALLOCATE ( TT2 ( N ) ,STAT = CHECKSTAT ) IF ( CHECKSTAT / = 0 ) THEN WRITE ( 6 , ) ERROR IN RREALLOC1D ALLOCATING TT2 MATRIX WRITE ( 6 , ) MATRIX IS DIMENSION TT2 ( N ) , WHERE WRITE ( 6 , ) N = ,N WRITE ( 6 , ) ALLOCATE RETURNS : CHECKSTAT = ,CHECKSTAT WRITE ( 6 , ) STOPPING CALL FLUSH ( 6 ) STOP ENDIF ENDIF ! TT2 ( 1 : SIZE ( PT1,1 ) ) = PT1 TT2 ( ( SIZE ( PT1,1 ) + 1 ) : N ) = 0.0 PT1 = TT2 ! IF ( ALLOCATED ( TT2 ) ) THEN DEALLOCATE ( TT2,STAT = CHECKSTAT ) IF ( CHECKSTAT 0 ) THEN WRITE ( 6 , ) DEALLOCATION FAILURE IN SUBROUTINE RREALLOC1D WRITE ( 6 , ) FAILED TO DEALLOCATE REAL VARIABLE TT2 WRITE ( 6 , ) WRITE ( 6 , ) CHECKSTAT = ,CHECKSTAT WRITE ( 6 , ) WRITE ( 6 , ) STOPPING CALL FLUSH ( 6 ) STOP ENDIF ELSE WRITE ( 6 , ) WEIRD : TT2 IS NOT ALLOCATED IN RREALLOC1D CALL FLUSH ( 6 ) ENDIF ! RETURN END SUBROUTINE RREALLOC1D ! SUBROUTINE IREALLOC1D ( PT1,N ) IMPLICIT NONE ! ! = ! PASSED THROUGH CALL STATEMENT ! = ! INTEGER , DIMENSION ( : ) , POINTER : PT1 INTEGER N ! ! = ! LOCAL VARIABLES ! = ! ! INTEGERS : ! INTEGER CHECKSTAT INTEGER , DIMENSION ( : ) , ALLOCATABLE , TARGET : TT2 ! IF ( .NOT.ALLOCATED ( TT2 ) ) THEN ALLOCATE ( TT2 ( N ) ,STAT = CHECKSTAT ) IF ( CHECKSTAT / = 0 ) THEN WRITE ( 6 , ) ERROR IN IREALLOC1D ALLOCATING TT2 MATRIX WRITE ( 6 , ) MATRIX IS DIMENSION TT2 ( N ) , WHERE WRITE ( 6 , ) N = ,N WRITE ( 6 , ) ALLOCATE RETURNS : CHECKSTAT = ,CHECKSTAT WRITE ( 6 , ) STOPPING CALL FLUSH ( 6 ) STOP ENDIF ENDIF ! TT2 ( 1 : SIZE ( PT1,1 ) ) = PT1 TT2 ( ( SIZE ( PT1,1 ) + 1 ) : N ) = 0 PT1 = TT2 ! IF ( ALLOCATED ( TT2 ) ) THEN DEALLOCATE ( TT2,STAT = CHECKSTAT ) IF ( CHECKSTAT 0 ) THEN WRITE ( 6 , ) DEALLOCATION FAILURE IN SUBROUTINE IREALLOC1D WRITE ( 6 , ) FAILED TO DEALLOCATE INTEGER VARIABLE TT2 WRITE ( 6 , ) WRITE ( 6 , ) CHECKSTAT = ,CHECKSTAT WRITE ( 6 , ) WRITE ( 6 , ) STOPPING CALL FLUSH ( 6 ) STOP ENDIF ELSE WRITE ( 6 , ) WEIRD : TT2 IS NOT ALLOCATED IN IREALLOC1D CALL FLUSH ( 6 ) ENDIF ! RETURN END SUBROUTINE IREALLOC1D 
